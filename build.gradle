allprojects {
    apply plugin: "java"

    sourceCompatibility = targetCompatibility = 1.8
    compileJava.options.encoding = "UTF-8"

    version = "0.0.1"
    group = "org.bookmc"

    repositories {
        maven {
            url "https://jitpack.io"
        }
        maven {
            url "https://libraries.minecraft.net/"
        }
        mavenCentral()
    }

    configurations {
        embed
        implementation.extendsFrom(embed)
    }

    dependencies {
        compileOnly "com.github.BookMC:services:61152c01b9"
        compileOnly("com.github.BookMC:modding:db7e06da52") {
            exclude module: "log4j-api"
            exclude module: "log4j-core"
        }
        compileOnly "com.github.BookMC:loader:a27843e880"
    }

    processResources {
        inputs.files "src/main/resources"
        outputs.dir "build/classes/main"
        copy {
            from("src/main/resources")
            into("build/classes/main")
        }
    }

    jar {
        from {
            configurations.embed.collect {
                it.isDirectory() ? it : zipTree(it)
            }
        }

        duplicatesStrategy DuplicatesStrategy.EXCLUDE

        exclude "META-INF/*.RSA", "META-INF/*.SF", "META-INF/*.DSA", "module-info.class"
    }
}